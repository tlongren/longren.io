---
title: 'Monitor SSH Activity on Your Server with Papertrail & Saved Searches'
author: Tyler Longren
type: post
date: 2014-09-15T12:18:34+00:00
url: /monitor-sshd-events-with-papertrail/
featured_image: /wp-content/uploads/2014/09/papertrail-not-listed-setup-e1410596439610.png
independent_publisher_primary_category:
  - Services
dsq_thread_id:
  - 3013722243
pageViews_cumul:
  - '{"hours":{"1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"","32":"","33":"","34":"","35":"","36":"","37":"","38":"","39":"","40":"","41":"","42":"","43":"","44":"","45":"","46":"","47":""},"days":{"2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":""},"weeks":{"3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":""},"months":{"4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":""}}'
pageViews:
  - '{"hours":{"1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"","32":"","33":"","34":"","35":"","36":"","37":"","38":"","39":"","40":"","41":"","42":"","43":"","44":"","45":"","46":"","47":""},"days":{"2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":""},"weeks":{"3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":""},"months":{"4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":""}}'
tags:
  - digitalocean
  - hosting
  - Internet
  - Linux
  - papertrail
  - Personal
  - services
  - tools

---
## Search for common phrases related to SSH logins {.subtitle}

[Papertrail][1] is good for all types of things, I especially enjoy it because it makes finding problems quite easy. Another fun thing to do with [Papertrail][1] is see how many people are trying to either login to your server via ssh, or attack sshd itself.

### Find Potential Break-In Attempts

You can save searches in Papertrail, which makes finding certain events extremely easy. When I want to see potential break-in attempts, I have a saved search for `not listed in AllowUsers`. My server names have been blacked out in the image below.  
[<img loading="lazy" src="https://i2.wp.com/longren.io/wp-content/uploads/2014/09/papertrail-not-listed-295x300.png?resize=295%2C300" alt="papertrail-not-listed" width="295" height="300" class="aligncenter size-medium wp-image-7443" srcset="https://i2.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-not-listed.png?resize=295%2C300&ssl=1 295w, https://i2.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-not-listed.png?resize=147%2C150&ssl=1 147w, https://i2.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-not-listed.png?resize=689%2C700&ssl=1 689w, https://i2.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-not-listed.png?w=941&ssl=1 941w" sizes="(max-width: 295px) 100vw, 295px" data-recalc-dims="1" />][2]

### Show All sshd Associated Event Logs

To see _all_ events associated with **sshd**, you can save a search for `program:sshd`. This will show all log entries generated by **sshd**. Again, server names have been censored.  
[<img loading="lazy" src="https://i0.wp.com/longren.io/wp-content/uploads/2014/09/papertrail-program-sshd-300x254.png?resize=300%2C254" alt="papertrail-program-sshd" width="300" height="254" class="aligncenter size-medium wp-image-7444" srcset="https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-program-sshd.png?resize=300%2C254&ssl=1 300w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-program-sshd.png?resize=150%2C127&ssl=1 150w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-program-sshd.png?resize=1024%2C868&ssl=1 1024w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-program-sshd.png?resize=700%2C594&ssl=1 700w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-program-sshd.png?w=1123&ssl=1 1123w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" />][3]

Papertrail has groups that you can put your servers into. Saved searches can be applied to a specific group of servers, or all servers. It&#8217;s really quite nice, especially if you have a server that almost nobody ever logs in to. Papertrail also lets you know the last time a log message was received from a server. For most servers, the last log event will have been `moments ago`.

### Receive Alerts for Saved Searches

One of the best features are the alerts on saved searches. If you have a server that nobody but you logs into but you, you can setup an alert for when someone logs in via SSH. Most of the time the alert will just be you logging in, but this is excellent information to have if someone else does manage to login. Someone could have obtained your private key or your password.

You can specify the minimum number of events needed before the alert is activated. I&#8217;ve got an alert setup that sends me an email after my public key has been accepted 20 times. The alert is sent once an hour. I have the minimum number of events so high because I login frequently with FileZilla and make small edits to files, which causes a lot of SSH logins.  
[<img loading="lazy" src="https://i2.wp.com/longren.io/wp-content/uploads/2014/09/papertrail-saved-search-alert-300x258.png?resize=300%2C258" alt="papertrail-saved-search-alert" width="300" height="258" class="aligncenter size-medium wp-image-7451" srcset="https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-saved-search-alert.png?resize=300%2C258&ssl=1 300w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-saved-search-alert.png?resize=150%2C129&ssl=1 150w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-saved-search-alert.png?resize=700%2C603&ssl=1 700w, https://i1.wp.com/www.longren.io/wp-content/uploads/2014/09/papertrail-saved-search-alert.png?w=883&ssl=1 883w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" />][4]

If you have to manage any servers at all, you might as well [give Papertrail a try][1]. They have a free plan that lasts forever. If you find that you need more than 100MB of log storage space, you can get [1GB for $5 per month][1], which is plenty for most folks. $5 only includes 1 day of log retention, [$7 per month gets you a week of log retention][1]. 

<div class="wpulike wpulike-default " >
  <div class="wp_ulike_general_class wp_ulike_is_not_liked">
    <button type="button"
					aria-label="Like Button"
					data-ulike-id="7441"
					data-ulike-nonce="2fcba9e108"
					data-ulike-type="likeThis"
					data-ulike-template="wpulike-default"
					data-ulike-display-likers="0"
					data-ulike-disable-pophover="0"
					class="wp_ulike_btn wp_ulike_put_image wp_likethis_7441"></button><span class="count-box"></span>
  </div>
</div>

[][5]{.later-button-el}

<div class='what-next'>
  <h2>
    Well, now what?
  </h2>
  
  <div class='hire'>
    <h3>
      Work with Me
    </h3>
    
    <p>
      I'm available for hire and always taking new clients, big and small. Got a project or an idea you'd like to discuss? Startup plan but no developer to make it happen? Just <a href='https://www.longren.io/contact/'>get in touch</a>, I'd love to see if I can help you out!
    </p></p>
  </div>
  
  <div class='hire'>
    <h3>
      Leave some Feedback
    </h3>
    
    <p>
      Got a question or some updated information releavant to this post? Please, <a href='#respond' title='Leave a comment'>leave a comment</a>! The comments are a great way to get help, I read them all and reply to nearly every comment. Let's talk. ðŸ˜€
    </p></p>
  </div>
  
  <div class='now-what-bottom-ad'>
    <h3>
      Longren.io is proudly hosted by <a href='https://www.digitalocean.com/?refcode=cbf49d0481c8'>DigitalOcean</a>
    </h3>
    
    <p>
      <span class='do_link'><a href='https://www.digitalocean.com/?refcode=cbf49d0481c8' rel='nofollow' target='_blank'><img alt='DigitalOcean' border='0' src='https://i0.wp.com/longren.io/wp-content/uploads/2014/03/digitalocean.png?w=1100&#038;ssl=1' data-recalc-dims="1" /></a></span><br /> <!--

<h3>Need Cloud Monitoring? Try Mist.io!</h3>

<span class='do_link'><a href='http://mist.io/?ref=tyler' rel='nofollow' target='_blank'><img alt='Mist.io' border='0' src='https://i0.wp.com/longren.io/wp-content/uploads/2014/04/mistio.jpg?w=1100&#038;ssl=1' data-recalc-dims="1"></a></span>--></div> </div>

 [1]: https://papertrailapp.com/?thank=33d541
 [2]: https://i2.wp.com/longren.io/wp-content/uploads/2014/09/papertrail-not-listed.png
 [3]: https://i1.wp.com/longren.io/wp-content/uploads/2014/09/papertrail-program-sshd.png
 [4]: https://i0.wp.com/longren.io/wp-content/uploads/2014/09/papertrail-saved-search-alert.png
 [5]: #